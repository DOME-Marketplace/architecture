<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=canonical type=text/html href=https://DOME-Marketplace.github.io/architecture/docs/><link rel=alternate type=application/rss+xml href=https://DOME-Marketplace.github.io/architecture/docs/index.xml><meta name=robots content="noindex, nofollow"><link rel="shortcut icon" href=/architecture/favicons/favicon.ico><link rel=apple-touch-icon href=/architecture/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/architecture/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/architecture/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/architecture/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/architecture/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/architecture/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/architecture/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/architecture/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/architecture/favicons/android-192x192.png sizes=192x192><title>DOME Technical Architecture | DOME Architecture</title>
<meta name=description content="Overview of the architecture of DOME"><meta property="og:url" content="https://DOME-Marketplace.github.io/architecture/docs/"><meta property="og:site_name" content="DOME Architecture"><meta property="og:title" content="DOME Technical Architecture"><meta property="og:description" content="This document describes the DOME technical architecture and its core components."><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta itemprop=name content="DOME Technical Architecture"><meta itemprop=description content="This document describes the DOME technical architecture and its core components."><meta itemprop=dateModified content="2024-07-27T21:43:01+02:00"><meta itemprop=wordCount content="11"><meta name=twitter:card content="summary"><meta name=twitter:title content="DOME Technical Architecture"><meta name=twitter:description content="This document describes the DOME technical architecture and its core components."><link rel=preload href=/architecture/scss/main.min.f1c94d4aa74e6e25d2eba60dfaeadf5394f1563d83ada07e5a8596766715ddc2.css as=style><link href=/architecture/scss/main.min.f1c94d4aa74e6e25d2eba60dfaeadf5394f1563d83ada07e5a8596766715ddc2.css rel=stylesheet><script src=https://code.jquery.com/jquery-3.7.1.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous></script></head><body class=td-section><header><nav class="td-navbar js-navbar-scroll" data-bs-theme=dark><div class="container-fluid flex-column flex-md-row"><a class=navbar-brand href=/architecture/><span class="navbar-brand__logo navbar-logo"><svg id="Livello_1" data-name="Livello 1" viewBox="0 0 559.98 168.36"><defs><style>.cls-1{fill:#fff}</style></defs><g><path class="cls-1" d="m105.22 115.62c4.91.83 10.37 1.14 16.09 1.04-3.18-7.01-6.78-13.53-10.13-19.21-3.59-.02-6.9-.1-9.83-.17.0.0-4.37 16.96 3.87 18.35h0z"/><path class="cls-1" d="m166.71 89.03c-8.11 3.32-16.86 5.37-25.49 6.62 2.85 5.7 5.4 11.77 7.57 17.84 8.44-1.71 16.41-4 22.98-6.56l1.22-3.45c.74-2.1-.26-6.12-2.5-10-.98-1.7-2.27-3.16-3.77-4.45h0z"/><path class="cls-1" d="m36.7 141.25 2.38 2.78c1.45 1.69 5.43 2.83 9.91 2.83 1.96.0 3.87-.38 5.74-1.04 1.18-8.68 3.78-17.29 7.02-25.39-6.25-.38-12.79-1.2-19.23-2.37-2.73 8.16-4.74 16.21-5.81 23.18h0z"/><path class="cls-1" d="m62.44 79.28c-3.18 3.84-6.18 8.43-8.96 13.44 6.91.68 13.46.83 19.01.83.92.0 1.81.0 2.71-.02 1.81-3.1 3.54-5.93 5.07-8.43.0.0-12.5-12.26-17.83-5.82z"/><path class="cls-1" d="m20.07 83.85c.41.21.83.39 1.24.6 3.7-2.63 8.14-4.5 12.72-6.1l2.25-3.89c2.72-4.71 2.65-11.11 1.68-18.23-7.03 2.59-14.57 4.97-21.09 8.33l-1.52 4.45c-.35 1.07-3.28 10.72 4.72 14.85h0z"/><path class="cls-1" d="m115.31 60.4c-1.73-4.66-4.2-9.55-7.15-14.46-4.48 6.25-8.33 12.63-11.58 18.38 1.78 3.12 3.37 6.03 4.77 8.6.0.0 16.87-4.69 13.96-12.53h0z"/><path class="cls-1" d="m63.5 14.95c-.98 1.7-1.6 3.54-1.97 5.49 6.93 5.36 13.09 11.91 18.48 18.77 3.51-5.32 7.49-10.56 11.67-15.47-5.7-6.45-11.67-12.21-17.17-16.62l-3.6.67c-2.19.41-5.17 3.29-7.41 7.16z"/><path class="cls-1" d="m63.37 116.53c7.15.36 14.03.12 20.06-.9 8.24-1.39 3.87-18.35 3.87-18.35-4.12.11-9.02.26-14.4.27-6.6.0-13.93-.21-21.43-1.03-11.32-1.24-23.02-3.84-33.23-9.1-.1-.05-.18-.1-.27-.15-10.82-5.84-6.58-19.01-6.41-19.52-.21.14-.42.28-.62.42-.06.04-.12.09-.18.13-.57.42-1.13.86-1.67 1.31-.05.04-.1.08-.14.12-.52.44-1.03.9-1.51 1.37-.08.07-.15.15-.23.22-.45.45-.89.91-1.31 1.39-.1.11-.2.23-.29.34-.39.46-.76.93-1.12 1.42-.1.14-.2.28-.3.43-.34.49-.67.99-.98 1.51-.08.14-.16.29-.24.43-.31.55-.6 1.11-.87 1.69-.05.11-.1.23-.15.34-.28.63-.54 1.28-.78 1.95-.02.06-.04.12-.06.17-.25.73-.47 1.49-.65 2.27-2.22 9.41 3.9 18.03 11.45 21.56 8.19 3.82 19.75 7.26 31.94 9.44 6.47 1.16 13.11 1.96 19.53 2.28h0z"/><path class="cls-1" d="m39.73 76.46c.13-.04.27-.09.4-.13 5.34-1.73 10.44-3.36 14.33-5.68.04-.02.07-.05.11-.07.35-.21.68-.42 1.01-.64.1-.07.2-.14.3-.21.26-.18.52-.37.77-.57.14-.11.28-.23.41-.35.2-.17.4-.33.58-.5.17-.15.32-.32.48-.48.15-.15.3-.29.43-.44.18-.2.35-.42.52-.63.1-.12.2-.24.29-.36.25-.34.49-.7.7-1.07s.4-.75.58-1.14c.06-.14.11-.29.17-.43.1-.25.2-.51.29-.77.06-.19.11-.4.16-.59.06-.22.12-.43.17-.66.06-.25.1-.5.14-.76.03-.18.07-.35.09-.53.04-.31.08-.63.11-.95.01-.12.02-.24.03-.36.03-.39.05-.79.05-1.19v-.13c.06-4.54-1.08-9.78-2.25-15.27-.03-.13-.06-.26-.09-.39-1.77-8.16-3.57-16.77-1.53-24.27.46-1.7 1.12-3.35 2.03-4.92 2.43-4.2 6.2-8.36 10.14-9.1-6.83-4.78-17.35-5.77-24.4.86-5.09 4.79-7.29 10.91-7.88 17.27.0.04.0.07.0.11-.86 10.35 2.35 22.01 3.89 32.66 1.18 8.18 1.37 15.77-2.05 21.7h.03z"/><path class="cls-1" d="m130.37 150.03c-.02-.45-.06-.91-.09-1.36-4.13-1.89-7.98-4.81-11.66-7.97h-4.49c-5.44.0-10.94 3.26-16.63 7.66 5.76 4.79 11.59 10.14 17.76 14.1l4.61-.91s3.03-.64 5.84-2.55c3.32-2.25 4.84-5.18 4.66-8.97z"/><path class="cls-1" d="m144.81 114.25c-2.23-6.18-4.86-12.33-7.79-18.06-3.27-6.37-6.91-12.2-10.81-16.92-5.33-6.44-17.83 5.82-17.83 5.82 2.15 3.52 4.74 7.68 7.44 12.34 3.31 5.72 6.78 12.17 9.82 19.07 4.59 10.42 8.19 21.86 8.73 33.33v.31c.36 12.5-13.66 15.3-13.72 15.32.1.05.21.09.31.14.21.1.42.2.63.29.23.1.46.2.69.29.12.05.24.1.36.15.24.1.49.19.73.28.12.05.25.09.37.14.23.08.45.16.68.23.16.05.31.1.47.15.19.06.38.12.58.17.2.06.41.12.61.17.15.04.3.08.45.12.25.06.51.12.77.18.11.02.21.05.32.07.3.06.61.12.92.17.07.0.13.02.2.03.35.06.7.11 1.05.15.03.0.06.0.08.0.39.04.77.08 1.16.11h0c1.59.11 3.2.06 4.84-.17h.03c.38-.05.76-.12 1.14-.19.04.0.07.0.11-.02.36-.07.72-.15 1.07-.24.06.0.12-.02.18-.04.41-.1.83-.22 1.25-.34 9.26-2.79 13.67-12.39 12.94-20.7-.78-9-3.59-20.73-7.8-32.38l.02.02z"/><path class="cls-1" d="m113.83 136.42c-4.18-3.76-8.14-7.37-12.1-9.58-.04-.02-.07-.04-.11-.06-.35-.2-.71-.38-1.06-.55-.11-.05-.22-.1-.33-.15-.29-.14-.58-.27-.88-.38-.17-.07-.34-.12-.51-.19-.24-.09-.48-.18-.73-.26-.22-.07-.44-.12-.65-.18-.2-.05-.4-.11-.6-.15-.27-.06-.54-.1-.81-.14-.15-.02-.3-.06-.45-.07-.43-.05-.85-.07-1.28-.07s-.85.03-1.28.07c-.15.02-.3.05-.45.07-.27.04-.54.08-.81.14-.2.04-.4.1-.6.15-.22.06-.44.11-.65.18-.24.08-.48.17-.73.26-.17.06-.34.12-.51.19-.29.12-.58.25-.88.38-.11.05-.22.1-.33.15-.35.17-.71.36-1.06.55-.04.02-.07.04-.11.06-3.96 2.21-7.92 5.82-12.09 9.58-.1.09-.21.19-.31.28-6.18 5.61-12.74 11.48-20.25 13.46-1.71.45-3.46.71-5.28.71-4.85.0-10.34-1.19-12.95-4.23-.72 8.31 3.68 17.91 12.94 20.7 6.7 2.02 13.1.85 18.9-1.81.03-.02.07-.03.1-.05 9.4-4.43 17.89-13.05 26.34-19.7 6.5-5.12 12.97-9.07 19.81-9.07-.1-.09-.2-.18-.3-.27v-.02z"/><path class="cls-1" d="m132.57 40.14c2.72 4.71 8.3 7.85 14.95 10.57 1.27-7.39 2.98-15.1 3.33-22.43l-3.09-3.54s-4.51-4.99-9.95-4.99c-1.81.0-3.54.54-5.27 1.66-.38.25-.76.5-1.14.76.43 4.52-.17 9.31-1.07 14.08l2.25 3.89h0z"/><path class="cls-1" d="m73.34 60.4C70.43 68.23 87.3 72.93 87.3 72.93c1.97-3.62 4.28-7.95 6.97-12.61 3.29-5.72 7.15-11.96 11.61-18.04 6.73-9.18 14.84-18.02 24.5-24.23.09-.06.18-.1.27-.16 10.65-6.56 20.08 4.18 20.12 4.22.0-.11-.02-.22-.03-.34-.02-.23-.04-.46-.07-.7-.03-.25-.06-.49-.09-.74-.02-.13-.03-.27-.05-.4-.04-.26-.08-.52-.12-.77-.02-.13-.04-.26-.07-.39-.04-.24-.09-.47-.14-.7-.03-.16-.07-.32-.1-.49-.04-.2-.09-.39-.14-.59-.05-.21-.1-.41-.16-.62-.04-.15-.08-.3-.12-.45-.07-.25-.15-.5-.23-.75-.03-.1-.07-.21-.1-.31-.1-.29-.2-.59-.31-.88-.02-.06-.05-.13-.07-.19-.13-.33-.26-.66-.4-.98.0-.03-.02-.05-.03-.08-.15-.36-.32-.71-.49-1.06h0c-.7-1.43-1.56-2.8-2.57-4.11.0.0.0-.01.0-.02-.24-.31-.49-.61-.74-.9-.02-.02-.04-.05-.06-.07-.24-.28-.49-.55-.75-.82-.04-.04-.08-.08-.12-.13-.3-.31-.6-.61-.92-.91-7.04-6.63-17.57-5.64-24.4-.86-7.41 5.18-16.16 13.47-24.15 22.94-4.23 5.02-8.25 10.38-11.74 15.78-3.89 6.02-7.11 12.09-9.24 17.82h0z"/><path class="cls-1" d="m188.21 83.25c-.17-.73-.38-1.44-.61-2.12-.06-.18-.12-.36-.18-.53-.17-.47-.35-.92-.54-1.36-2.02-4.67-5.38-8.32-9.36-11.2-.11-.08-.22-.15-.34-.23-8.54-5.96-20.29-9.03-30.31-13.04-7.68-3.07-14.34-6.69-17.76-12.62-.03.14-.06.27-.09.41-1.17 5.49-2.31 10.73-2.25 15.26v.13c0 .4.03.8.05 1.19.0.12.02.24.03.36.03.32.06.64.11.95.03.18.06.35.09.53.04.25.09.51.14.76.05.22.11.44.17.66.05.2.1.4.16.59.08.26.19.51.29.77.06.14.1.29.17.43.17.39.36.77.58 1.14s.45.73.7 1.07c.09.12.2.24.29.36.17.21.34.43.52.63.14.15.29.29.43.44.16.16.31.32.48.48.19.17.39.34.58.5.14.12.27.23.41.35.25.19.51.38.77.57.1.07.2.14.3.21.33.22.66.43 1.01.64.04.02.07.05.11.07 3.89 2.32 9 3.95 14.34 5.68.13.04.27.09.4.13 7.95 2.54 16.31 5.29 21.78 10.81 1.24 1.25 2.34 2.65 3.25 4.22 2.43 4.2 4.14 9.55 2.81 13.33 7.55-3.53 13.67-12.15 11.45-21.56h.02z"/></g><g><path class="cls-1" d="m291.86 51.75c6.1 6.4 9.16 15.56 9.16 27.47s-3.05 21.07-9.16 27.47c-6.1 6.4-14.92 9.61-26.46 9.61h-34.04V42.14h34.04c11.53.0 20.35 3.2 26.46 9.61zm-17.81 42.92c2.25-3.26 3.37-8.41 3.37-15.45s-1.12-12.19-3.37-15.45c-2.25-3.26-6.07-4.89-11.46-4.89h-8.31v40.67h8.31c5.39.0 9.21-1.63 11.46-4.89h0z"/><path class="cls-1" d="m373.48 51.08c6.52 6.71 9.78 16.08 9.78 28.14s-3.26 21.44-9.78 28.14c-6.52 6.71-15.58 10.06-27.19 10.06-7.64.0-14.25-1.5-19.83-4.49-5.58-3-9.87-7.38-12.86-13.15-3-5.77-4.49-12.62-4.49-20.56s1.5-14.79 4.49-20.56c3-5.77 7.28-10.15 12.86-13.14 5.58-3 12.19-4.49 19.83-4.49 11.61.0 20.67 3.35 27.19 10.05zm-37.41 12.58c-2.25 3.41-3.37 8.59-3.37 15.56s1.12 12.15 3.37 15.56 5.66 5.11 10.22 5.11 7.96-1.69 10.17-5.06c2.21-3.37 3.31-8.57 3.31-15.62s-1.11-12.24-3.31-15.62c-2.21-3.37-5.6-5.06-10.17-5.06s-7.98 1.71-10.22 5.11v.02z"/><path class="cls-1" d="m485.16 116.29h-20.22V86.63l.45-23.93h-.23l-16.29 53.59h-18.43L414.37 62.7h-.34l.45 23.93v29.66h-20.22V42.14h32.36l10 35.17 3.71 14.72h.22l3.71-14.72 10-35.17h30.89v74.15h.01z"/><path class="cls-1" d="m559.98 99.1v17.19h-61.23V42.14h59.77v17.19h-36.85v12.02h29.44V87.3h-29.44v11.8h38.31.0z"/></g></svg></span><span class=navbar-brand__name>DOME Architecture</span></a><div class="td-navbar-nav-scroll ms-md-auto" id=main_navbar><ul class=navbar-nav><li class=nav-item><a class="nav-link active" href=/architecture/docs/><span>Docs</span></a></li></ul></div><div class="d-none d-lg-block"></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>This is the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.</p><p><a href=/architecture/docs/>Return to the regular view of this page</a>.</p></div><h1 class=title>DOME Technical Architecture</h1><ul><li>1: <a href=#pg-e8ddd90ca2d34807595f349b96e6f7d7>Overview</a></li><li>2: <a href=#pg-91da0900e7701d65a64e9db473a689e8>Data Model</a></li><ul></ul><li>3: <a href=#pg-b778524050260f3902f959d44e1a2437>Catalog Replication</a></li><ul></ul><li>4: <a href=#pg-11661219278fb5dba789061a814e97a8>BFT Event Bus</a></li><ul></ul><li>5: <a href=#pg-690a090b0b600dddeff23613556723f4>Digital Identity</a></li><ul><li>5.1: <a href=#pg-08aede52ebd08bb8890027051aa173f2>The LEARCredential</a></li><li>5.2: <a href=#pg-bda96d33c7d41ff6f74d30065b2ef786>Authentication</a></li><li>5.3: <a href=#pg-8d7286a5b9fd6ef45bb80b32283d09ca>Powers</a></li><li>5.4: <a href=#pg-22ca1bc8db2ac3cc5e68ac62f23b328f>Access Control</a></li><ul></ul></ul><li>6: <a href=#pg-2e396586ba727f8df9221cf7d5733a86>Service Certification</a></li><ul></ul><li>7: <a href=#pg-7c742aa5039751635a3d8b7919c51966>Company registration</a></li><ul><li>7.1: <a href=#pg-ad4564e2ca35cc0862b65da41d4ab5fa>Overview</a></li><li>7.2: <a href=#pg-4c57c1f351fde75c7ef3b9f12b1f3857>LEARCredential (digital process)</a></li><li>7.3: <a href=#pg-df23d5d93d142604a701c7b1cbd33989>LEARCredential (manual process)</a></li><li>7.4: <a href=#pg-c57585a65dd796097af46d460d6da26a>Powers of Representation</a></li></ul></ul><div class=content><p>This document describes the DOME technical architecture and its core components.</p></div></div><div class=td-content><h1 id=pg-e8ddd90ca2d34807595f349b96e6f7d7>1 - Overview</h1><div class=lead>Overview of the DOME technical architecture.</div><p>The DOME ecosystem consists of a set of federated marketplaces, replicating the catalogue data among them in a secure way.</p><p>The diagram below provides an overview of the core components of DOME.</p><figure class="card rounded p-2 td-post-card mb-4 mt-4"><img src=/architecture/docs/overview/YUMKET%20technical%20architecture.drawio.png alt="The core components of DOME"><figcaption class="card-body px-0 pt-2 pb-0"><p>The core components of DOME</p></figcaption></figure><p>In July 4th 2024, DOME entered into production with a single marketplace instance operated by the DOME Consortium (the dotted rectangle on the left). In the coming months it is expected that other instances of marketplaces, operated by different entities, will start integrating and federating among them to create the DOME ecosystem (one of those federated instances is shown on the right of the diagram).</p><p>The replication of catalog data is implemented with a layered architecture:</p><dl><dt>Marketplace Business layer</dt><dd>Even though the different instances may use natively different data models, they have to agree on a common data model and semantics. DOME uses the standard <a href=https://www.tmforum.org/oda/open-apis/>TM Forum&rsquo;s Open APIs</a> and associated data model.</dd></dl><p>TM Forum Open APIs have been widely adopted by the industry as a standard interoperability method, with more than 640,000 downloads by 39,000 software developers from 2,500 organizations.</p><p>Over 70+ REST-based, Event driven and Domain Specific Open APIs have been collaboratively developed by TM Forum members working within the Open API project. This team creates a full set of Open API assets for members to implement Open APIs - from guidelines (REST API Design Guidelines), to specification, to usable code, through to the compliance test kits - see the Open API directory for more details.</p><dl><dt>Catalog Replication layer</dt><dd>This is where the actual replication of the data happens. All instances have a store with the relevant catalog data in the standard TM Forum format. The replication logic in each instance talk to each other with the help of a byzantine fault tolerant Publish/Subscribe event bus implemented by the lower layer.</dd><dt>Trusted Publish/Subscribe layer</dt><dd>This layer implements a Publish/Subscribe event bus, where the lifecycle events of the relevant catalog objects are managed. For example, when a new product offering is published in one of the instances of the marketplaces, an event is published in the bus. All other instances which are subscribed to that type of event will receive the event and if the necessary conditions are met, the replication logic in that instance will retrieve the associated data from the origin instance.</dd></dl><p>The Publish/Subscribe event bus is Byzantine Fault Tolerant (BFT), which means that is continues working even in the presence of malicious actors who control one or more servers in the infrastructure (up to a given threshold given by the actual properties of the infrastructure).</p></div><div class=td-content style=page-break-before:always><h1 id=pg-91da0900e7701d65a64e9db473a689e8>2 - Data Model</h1><div class=lead>Using the TM Forum Open APIs and data model for interoperability and federation of marketplaces.</div><p>In a decentralised federated ecosystem like DOME, interoperability is a key requirement because we need the different marketplace instances in the DOME ecosystem to exchange catalog data and use the information for their users.</p><p>To achieve that, it is useful to think of interoperability at different layers:</p><ul><li><p><strong>Trust and digital identities level</strong>. A prerequisite for the exchange of data in DOME is that all participants trust to each other with a given level of assurance, and that they use a common digital identity system so they know who is who.</p></li><li><p><strong>Data model and semantic level</strong>. If the participants do not share a common semantic data model, it is extremely difficult to engage in automated and efficient data exchanges.</p></li><li><p><strong>Technical communications mechanisms level</strong>. Eventually, data must be echanged via common communication mechanisms, and the parties must agree on the standards used on this level to be able to connect and exchange the data.</p></li></ul><p>We are interested in this section on the data model and semantic level, as the following figure describes.</p><figure class="card rounded p-2 td-post-card mb-4 mt-4"><img src=/architecture/docs/datamodel/data_for_replication.png alt="The role of common data model in replication."><figcaption class="card-body px-0 pt-2 pb-0"><p>The role of common data model in replication.</p></figcaption></figure><p>In the DOME ecosystem, each marketplace instance uses most probably a different data model, depending on the actual implementation of the marketplace software. Trying to force all marketplace operators to use a single software for their marketplace instances is not reasonable.</p><p>There are many implementations of marketplaces out there, some of them Open Source. Of course, each implementation has its own data model, with varying degrees of sophistication. However, we have found that trying to use the data model defined by one of those implementations is also not reasonable.</p><p>In DOME we have chosen to focus on the data model, not on the software implementations of marketplaces. Instead of inventing the wheel, we wanted an existing data model:</p><ul><li>designed by a community as large as possible, with proper governance model</li><li>suited for marketplace catalog data</li><li>focused on open data models and open APIs for interoperability across complex heterogeneous ecosystems</li><li>as mature as possible, and as widely adopted as possible, with as many different implementations by different entities as possible</li></ul><p>We chose the <a href=https://www.tmforum.org/oda/open-apis/>TM Forum&rsquo;s Open API project</a>, which complies with all those requirements, and there is a big community around the data model and related APIs. See for example the dashboard for July 2024 in the figure below.</p><figure class="card rounded p-2 td-post-card mb-4 mt-4"><img src=/architecture/docs/datamodel/tmforum-api-dashboard-2024-08.png alt="TM Forum data model and APIs ecosystem."><figcaption class="card-body px-0 pt-2 pb-0"><p>TM Forum data model and APIs ecosystem.</p></figcaption></figure><p>For the replication of catalog data, we use in DOME a subset of the whole set of TM Forum APIs, specifically the ones related to the Product APIs, as described below.</p><figure class="card rounded p-2 td-post-card mb-4 mt-4"><img src=/architecture/docs/datamodel/tmforum-apis-used.png alt="The subset of APIs used in DOME."><figcaption class="card-body px-0 pt-2 pb-0"><p>The subset of APIs used in DOME.</p></figcaption></figure><p>The following diagram provides a simplified description of the main entities involved in the actual data model used. The model has provisions for extensions, and in DOME we have made use of that extensibility to implement things related to Verifiable Credentials and trusted replication, for example.</p><figure class="card rounded p-2 td-post-card mb-4 mt-4"><img src=tmforum-datamodel.png alt="The main entities in the DOME data model."><figcaption class="card-body px-0 pt-2 pb-0"><p>The main entities in the DOME data model.</p></figcaption></figure></div><div class=td-content style=page-break-before:always><h1 id=pg-b778524050260f3902f959d44e1a2437>3 - Catalog Replication</h1><div class=lead>The mechanism for replicating the data among the marketplace instances, and only the data that owners wish to replicate.</div><div class="pageinfo pageinfo-primary"><p>This is a placeholder, content is being added.</p></div></div><div class=td-content style=page-break-before:always><h1 id=pg-11661219278fb5dba789061a814e97a8>4 - BFT Event Bus</h1><div class=lead>The Byzantine Fault Tolerant (BFT) Publish/Subscribe event bus used in the replication of catalogue data.</div><div class="pageinfo pageinfo-primary"><p>This is a placeholder, content is being added.</p></div></div><div class=td-content style=page-break-before:always><h1 id=pg-690a090b0b600dddeff23613556723f4>5 - Digital Identity</h1><div class=lead>Decentralised Digital Identity of organisations and its employees, aligned with eIDAS2 and the EU Digital Identity Wallet .</div></div><div class=td-content><h1 id=pg-08aede52ebd08bb8890027051aa173f2>5.1 - The LEARCredential</h1><div class=lead>The LEARCredential as an electronic mandate for powerful authentication and access control in DOME and beyond.</div><p>The <code>LEARCredential</code> is a machine-readable legal document representing an electonic Mandate (known also as Company Authorization Letter). In this context, the term Mandate is used to describe the concept of <strong>delegating specific permissions and powers to an employee of an organisation, enabling that employee to act on behalf of the company in a specific set of matters or tasks</strong>. We explicitly focus on the business environment and do not cover natural persons acting as citizens.</p><p>Instead of inefficient and insecure paper or PDFs, in DOME we use <strong>Verifiable Credentials</strong> to represent an eMandate. Given that we are in the EU, in DOME we use <strong>eIDAS electronic signatures or seals</strong> to make the credential a legal document with higher legal certainty than using other types of digital signatures (for example, a qualified electronic signature has in the EU the same legal validity as a handwritten signature).</p><p>In DOME, the specific powers being delegated are related to the interaction of an employee of an organisation with DOME, for example to authorise the employee perform onboarding or creating a Product Offering in the marketplace.</p><p>The LEARCredential (<strong>L</strong>egal <strong>E</strong>ntity <strong>A</strong>uthorised <strong>R</strong>epresentative <strong>Credential</strong>):</p><ul><li>is a Verifiable Credential that a legal entity (an organisation) issues to an employee (or subcontractor),</li><li>includes the list of specific powers (or authorisations) that are delegated to an employee, so the employee can act on behalf of the legal entity</li><li>can be used also as an <strong>authentication mechanism</strong>, eliminating the need for passwords or complex identity management systems</li><li>the receiver of the credential can perform <strong>access control</strong> using the powers that are included inside the credential.</li></ul><p>The figure below describes a high-level view of the LEARCredential.</p><figure style=width:60% class="card rounded p-2 td-post-card mb-4 mt-4"><img src=/architecture/docs/identity/10_learcredential/learcredential-overview.png alt="Composition of a LEARCredential"><figcaption class="card-body px-0 pt-2 pb-0"><p>Composition of a LEARCredential</p></figcaption></figure><p>The data model of the LEARCredential is based in the <a href=https://github.com/everis-rpam/RPaM-Ontology/wiki/Ontology-Development-Report>RPaM-Ontology</a>, which is a project started in 2018 by the Directorate-General for Informatics (DG-DIGIT) of the European Commission, funded by the ISA Programme, to organise and support the development of an ontology about the Representation of Powers and Mandates, from now on the RPaM Ontology.</p><p>We adapt the results of that project, with simplifications and specialisations, to the concrete environment where we use the LEARCredential. To facilitate the job of the reader of this document, in some sections we copy literal sentences from the RPaM Ontology project, and adapt the texts to our requirements. However, the reader is encouraged to access the original documents for more details and understand the original approach, including the <a href=https://everis-rpam.github.io/Glossary.html>RPaM Ontology Glossary</a>.</p><h2 id=the-trust-framework-for-the-learcredential>The Trust Framework for the LEARCredential<a class=td-heading-self-link href=#the-trust-framework-for-the-learcredential aria-label="Heading self-link"></a></h2><p>The LEARCredential is based on the existing eIDAS (electronic Identification, Authentication and Trust Services).</p><blockquote><p>The eIDAS Regulation established the framework to ensure that electronic interactions between businesses are safer, faster and more efficient, no matter the European country they take place in. It is a European Regulation that created one single framework for electronic identification (eID) and trust services, making it more straightforward to deliver services across the European Union.<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></p></blockquote><p>The main eIDAS trust services that DOME relies on are the <strong>Electronic signature (eSignature)</strong> and the <strong>Electronic seal (eSeal)</strong>. An eSignature is the expression in an electronic format of a person’s agreement to the content of a document or set of data. Qualified eSignatures have the same legal effect as hand written signatures. An eSeal is similar in its function to the traditional business stamp. It can be applied to an electronic document to guarantee the origin and integrity of a document.</p><p>In DOME we accept both for the creation of a LEARCredential. For the rest of the document we will use the term <code>electronic signature</code> to refer to both, except when the difference is important for the objectives of the explanation.</p><p>The figure below describes at a high level how an organisation can create a LEARCredential in a self-service way, when the legal representative of the company has an eIDAS certificate. The process is essentially the same as when electronically signing a PDF. Instead of using a computer program that can sign PDFs (e.g., Acrobat Reader), the legal representative uses a program that can generate and sign Verifieble Credentials. In DOME we provide such a program, just in case an organisation dees not yet have its own. In addition, for organisations that are lagging in digitalisation and do not still have an eIDAS certificate (can not use electronic signatures), DOME also provides a third-party creation and signature process that can be used in the meantime.</p><figure class="card rounded p-2 td-post-card mb-4 mt-4"><img src=/architecture/docs/identity/10_learcredential/learcredential-trust-source.png alt="Composition of a LEARCredential"><figcaption class="card-body px-0 pt-2 pb-0"><p>Composition of a LEARCredential</p></figcaption></figure><h2 id=the-mandate>The Mandate<a class=td-heading-self-link href=#the-mandate aria-label="Heading self-link"></a></h2><p>According to the RPaM Glossary, a &ldquo;mandate is a record that describes the terms under which a mandator grants a representation power to a mandatee&rdquo;.</p><p>In DOME, the mandate is composed of three related objects: <code>mandator</code>, <code>mandatee</code>, <code>power</code> and <code>signer</code>. The mandate object is signed or sealed with an advanced or qualified signature or seal using an eIDAS certificate.</p><h3 id=mandator>Mandator<a class=td-heading-self-link href=#mandator aria-label="Heading self-link"></a></h3><p>The object mandator identifies the employee of the company who is delegating a subset of her powers on the mandatee.</p><p>The mandator is either:</p><ul><li><p>a legal representative of the company, according to the official records associated to the incorporation of the organisation (e.g., the business registry of the country of incorporation); or</p></li><li><p>an employee who is a mandatee in another mandate where the mandator is a legal representative of the company. We do not support more than two levels of delegation.</p></li></ul><h3 id=mandatee>Mandatee<a class=td-heading-self-link href=#mandatee aria-label="Heading self-link"></a></h3><p>The mandatee is the person granted with the power to represent (and act as) the company in some specific actions with third-parties. The powers granted to the mandatee must be a subset of the powers of the mandator. For example, an employee (the mandatee) can be empowered by the legal representative of the company (the mandator) to perform the onboarding process in DOME.</p><p>The object mandatee identifies the employee on whom a subset of powers is delegated. The mandatee object contains:</p><ul><li><p>A set of attributes of the employee which are required by the specific use case where the LEAR Credential will be used, for example to onboard in the DOME ecosystem and for creating a ProductOffering in the marketplace. Those attributes can be considered equivalent to the fields that would be filled in a form when a &ldquo;classical&rdquo; PDF document would be used to authorise an employee.</p></li><li><p>A public key associated to the employee and where the employee is the sole controler of the associated private key. This is required to enable the use of the LEARCredential containing the mandate as an efficient, scalable and secure authentication and authorisation mechanism.</p></li></ul><p>The private key controlled by the employee is used to prove to Relying parties receiving the LEARCredential that the holder and presenter of the credential is the same person identified in the mandatee object. We support two mechanisms for the public key in the mandatee object:</p><ul><li>Using a did:key where the employee controls the private key associated to the did:key.</li><li>Using an eIDAS certificate owned by the employee.</li></ul><h3 id=signer>Signer<a class=td-heading-self-link href=#signer aria-label="Heading self-link"></a></h3><p>The Signer is either the Mandator or a third-party that attests that the Mandator really delegated the powers to the Mandatee. The Signer is the entity that performs an advanced or qualified signature or seal using an eIDAS certificate.</p><p>The Signer is the entity that has to be trusted by the receiver of the LEARCredential.</p><h3 id=power>Power<a class=td-heading-self-link href=#power aria-label="Heading self-link"></a></h3><p>This object is a list of each specific power that is delegated from the mandator to the mandatee. The powers must be concrete and as constrained as possible, and must follow a taxonomy with the semantics well specified.</p><p>In DOME, we have specified a power taxonomy targeted at the interactions with the DOME Federated Marketplace. This means that the actions are well defined, homogeneous and standardised for the ecosystem. We are basically replacing the current mechanisms for Mandates (e.g., paper or PDF) with a more efficient, machine-processable representation in the form of a Verifiable Credential.</p><p>Our Power Taxonomy could be generalised to other actions involving private sector companies, but it is out of scope of this version of the document.</p><p>This object is an array where each element is a power that is delegated from the Mandator to the Mandatee. The fields of each power object are:</p><ul><li><p><code>id</code>: REQUIRED. The identifier of the power, which must be unique in the context of the Credential where it is included. It can be used as a reference when performing access control, for example in the audit records to identify the specific power that was used to grant access to some protected resource.</p></li><li><p><code>powerSource</code>: OPTIONAL. The Mandator draws the power from one (or more) sources of power, e.g., 1) a concrete Legislation; 2) a piece of evidence (as another Mandate, in which case the mandator was a mandatee in that other mandate) and/or 3) a Natural Person with a specific profession that invest him/her with the authority to order to a mandator with a specific role the creation of a mandate, e.g. a judge authorising a civil servant (a <code>Mandator</code> that is a Natural Person with the appropriate role) to create a mandate for a relative to represent an incapacitated person).</p><p>In DOME, there are three cases with specific sources of power:</p><ul><li><p>When the Mandator is a legal representative of the company, and the LEARCredential is signed with the eIDAS certificate of representation of the legal representative. In this case, the <code>powerSource</code> claim can be ommitted as it is implicit in the eIDAS signature. Alternatively, the <code>powerSource</code> claim is an object with the following fields:</p><ul><li><code>type</code>, with value <code>eulaw</code>.</li><li><code>evidence</code>, with value <a href="https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX:32014R0910">&ldquo;https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX:32014R0910&rdquo;</a>.</li></ul></li><li><p>When the Mandator is a natural person who is the Mandatee in another LEARCredential. The <code>powerSource</code> claim is an object with the following fields:</p><ul><li><code>type</code>, with value <code>LEARCredential</code>.</li><li><code>format</code>, with the value <code>jwt_vc_json</code>.</li><li><code>evidence</code>, with the LEARCredential where the Mandator is a Mandatee, in <code>jwt_vc_json</code> format.</li></ul></li><li><p>When the Mandator is a legal representative of the company, but does not have an eIDAS certificate of representation, the Mandator can not sign the LEARCredential. In this case, there must be a trusted third-party which attests that the Mandator is effectively a legal representative of the company. This trusted third-party must perform the required due diligence to confirm the relationship, and then sign the credential with its eIDAS certificate.</p><p>In DOME, one of the trusted third-parties (trusted by DOME) is the DOME Operator itself, where the employees dedicated to the onboarding of participants perform the manual checks on the documentation provided by the Mandator/Mandatee, and then create and sign the LEARCredential.</p><p>In this case, the <code>powerSource</code> claim is an object with the following fields:</p><ul><li><code>type</code>, with value <code>attestation</code>.</li><li><code>evidence</code>, with value the eIDAS certificate of the attester.</li></ul><p>In this case, the <code>mandate</code> object must contain an additional object called <code>attester</code>, identifying the entity that makes the attestation and with the same fields as the <code>mandator</code> object in the case where the Mandator signs the LEARCredential with an eIDAS certificate.</p></li></ul></li><li><p><code>tmf_type</code>: The type of power, which in DOME may be:</p><ul><li><p><code>Domain</code>: The mandatee has access to the services provided by one or more organisations where the services have been classified as belonging to that domain. Access to the services is subject to the restrictions defined by <code>action</code> and <code>function</code> below. The classification of services is arbitrary and is defined by the service providers. A typical scenario is when some service providers agree on a classification of the services that they provide collaboratively in the context of an ecosystem (like DOME), and the possible domains are made public, including the mapping to a given set of services in each provider.</p></li><li><p><code>Organization</code>: The mandatee has access only to the services provided by one or more organizations, identified specifically in the power.</p></li></ul><p>Other types of powers can be defined, making the system extensible.</p></li><li><p><code>tmf_domain</code>: Required when the <code>tmf_type</code> claim has the value <code>Domain</code> or <code>Organization</code>. It is an array with the names of the Domains or Organisations where the Mandatee is authorised to interact with this Mandate.</p><p>The names must be unique (e.g. via a namespace) to avoid potential clashes in different ecosystems.</p><p>In DOME, for the powers of onboarding in DOME and for creating a <code>ProductOffering</code>, the <code>tmf_domain</code> claim must be an array with a single item with the value <code>DOME</code>.</p></li><li><p><code>tmf_function</code>: A string specifying the name of the function that the Mandatee can perform. The definition of the possible functions is done by the Verifier (the entity with which the Mandatee will interact with the LEAR Credential).</p><p>In DOME, two essential functions for Cloud Service Providers (CSP) accessing the marketplace are <code>Onboarding</code> and <code>ProductOffering</code>, which enable the Mandatee to use the services provided by DOME to onboard organisations in the ecosystem and (if it is onboarded previously) to create a ProductOffering, respectively.</p></li><li><p><code>tmf_action</code>: An array with the concrete actions belonging to the function that the Mandatee is allowed to execute.</p><p>In DOME, the possible actions for CSPs accessing the marketplace are:</p><ul><li><code>Execute</code> when <code>tmf_function</code> is <code>Onboarding</code>.</li><li>Any combination of <code>Create</code>, <code>Update</code> and <code>Delete</code> when <code>tmf_function</code> is <code>ProductOffering</code>.</li></ul></li></ul><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>Discover eIDAS: <a href=https://digital-strategy.ec.europa.eu/en/policies/discover-eidas>https://digital-strategy.ec.europa.eu/en/policies/discover-eidas</a>.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><div class=td-content style=page-break-before:always><h1 id=pg-bda96d33c7d41ff6f74d30065b2ef786>5.2 - Authentication</h1><div class=lead>Authentication in DOME with the LEARCredential, both for Human-to-Machine (H2M) and Machine-to-Machine (M2M) use cases.</div><p>DOME uses Verifiable Credentials for authentication and access control of the users interacting with the DOME services.</p><p>In this document we describe <strong>how you can integrate the DOME authentication mechanism in your own applications</strong>. It is very easy.</p><p>You do not need to know the underlying technical details to use it, but if you are interested you can look <a href=https://dome-marketplace.github.io/powers-of-representation/index.html>here</a>.</p><p>There are two types of users that can authenticate to DOME services:</p><ul><li>Employees of companies using DOME services. We call this the Human-to-Machine (M2M) flows.</li><li>Applications or machines owned or operated by an organisation, accessing the DOME services. We call this the Machine-to-Machine (M2M) flows.</li></ul><p>We first explain the H2M flow: how your application can authenticate employees of companies (including your own company, of course). Later we describe the M2M flow.</p><h1 id=human-to-machine-h2m-authentication-flow>Human-to-Machine (H2M) authentication flow<a class=td-heading-self-link href=#human-to-machine-h2m-authentication-flow aria-label="Heading self-link"></a></h1><figure class="card rounded p-2 td-post-card mb-4 mt-4"><img src=/architecture/docs/identity/20_authentication/DOMEAuthentication-H2M-flow-overview.drawio.png alt="Two applications authenticating with Verifiable Credentials"><figcaption class="card-body px-0 pt-2 pb-0"><p>Two applications authenticating with Verifiable Credentials</p></figcaption></figure><p>DOME provides a component called the <strong>VCVerifier</strong> which makes very easy for applications to integrate authentication with Verifiable Credentials. If the application programmer knows how to use <a href=https://en.wikipedia.org/wiki/Social_login>Social Login</a>, then she already knows who to integrate authentication with Verifiable Credentials.</p><p>For the Application, the VCVerifier is just an OpenID Provider (OP), connecting to it using the standard <a href=https://openid.net/developers/how-connect-works/>OpenID Connect</a> protocol.</p><p>The Application does not need any knowledge about how to talk to the Wallet to receive the Verifiable Credential from the user. This complexity is hidden from the application by the VCVerifier. The Application never talks to the Wallet, only to the VCVerifier.</p><p>Once the VCVerifier has received the Verifiable Credential from her Wallet and performed a set of verifications (according to a defined policy), it sends to the Application both the Verifiable Credential and an Access Token that the Application can use to access protected resources as in any other OpenID Connect flow.</p><h2 id=parameters-of-the-vcverifier>Parameters of the VCVerifier<a class=td-heading-self-link href=#parameters-of-the-vcverifier aria-label="Heading self-link"></a></h2><p>You have to tell your Application some things before it can talk to the VCVerifier.</p><p>When talking to the VCVerifier, your Application MUST use the OIDC <strong>Authorization Code Flow</strong>. No other OIDC flows are supported.</p><p>Your Application must use the following endpoints of the VCVerifier during the flow:</p><ul><li><strong>Authorization Endpoint</strong>: <a href=https://verifier.dome-marketplace-prd.org/auth>https://verifier.dome-marketplace-prd.org/auth</a></li><li><strong>Token Endpoint</strong>: <a href=https://verifier.dome-marketplace-prd.org/token>https://verifier.dome-marketplace-prd.org/token</a></li><li><strong>UserInfo Endpoint</strong>: <a href=https://verifier.dome-marketplace-prd.org/userinfo>https://verifier.dome-marketplace-prd.org/userinfo</a></li></ul><h2 id=starting-the-authentication-request>Starting the Authentication Request<a class=td-heading-self-link href=#starting-the-authentication-request aria-label="Heading self-link"></a></h2><p>Before any authentication can take place, your Application has to be registered with the VCVerifier. This is done during the onboarding process in DOME, or at any time later, contacting the onboarding team.</p><p>As part of the registration, you will receive a <strong>Client Identifier</strong> and a <strong>Client Secret</strong>, that your Application must use according to the OIDC standard.</p><p>Typically, you will display to the user a Login button, and when the user clicks the button, your Application will redirect the user to the VCVerifier, passing some parameters as per the OIDC specifications. This is called an <strong>Authentication Request</strong>.</p><p>The following is an example HTTP 302 redirect response by the Application, which triggers the browser of the user to make an Authentication Request to the Authorization Endpoint of the VCVerifier (with line wraps within values for display purposes only).</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=display:flex><span><span style=color:#204a87;font-weight:700>HTTP</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#0000cf;font-weight:700>1.1</span> <span style=color:#0000cf;font-weight:700>302</span> <span style=color:#c00;font-weight:700>Found</span>
</span></span><span style=display:flex><span><span style=color:#000>Location</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000>https://verifier.dome-marketplace.org/auth?</span>
</span></span><span style=display:flex><span>    <span style=color:#000>response_type=code</span>
</span></span><span style=display:flex><span>    <span style=color:#000>&amp;client_id=did:key:wejkdew87fwhef9833f4</span>
</span></span><span style=display:flex><span>    <span style=color:#000>&amp;request_uri=https%3A%2F%2Fdome-marketplace.org%2Fapi%2Fv1%2Frequest.jwt</span>
</span></span><span style=display:flex><span>    <span style=color:#000>%23GkurKxf5T0Y-mnPFCHqWOMiZi4VS138cQO_V7PZHAdM</span>
</span></span><span style=display:flex><span>    <span style=color:#000>&amp;state=af0ifjsldkj&amp;nonce=n-0S6_WzA2Mj</span>
</span></span><span style=display:flex><span>    <span style=color:#000>&amp;scope=openid%20learcred</span>
</span></span></code></pre></div><p>Note the following:</p><ul><li><p>The Authentication Request MUST use the <strong>Authorization Code Flow</strong>, by specifying <strong>response_type=code</strong>. This means that all tokens (including the claims of the Verifiable Credential) are returned from the Token Endpoint.</p></li><li><p>The <strong>client_id</strong> is the one assigned to your Application when registered in the VCVerifier.</p></li><li><p>The Authentication Request MUST include the scope <strong>learcred</strong>, which tells the VCVerifier that the Application is requesting a LEARCredential (the one used in DOME for authentication). This scope is added to the OIDC compulsory scope <strong>openid</strong>.</p></li><li><p>The Authorization Request MUST use the <strong>request_uri</strong> parameter which enables the request to be passed by reference, as described in <a href=https://openid.net/specs/openid-connect-core-1_0.html#RequestUriParameter>section 6.2. Passing a Request Object by Reference</a> of the OpenID Connect spec.</p></li><li><p><strong>state</strong> is used by your Application to match this request with the future reply, in order to support multiple users at the same time.</p></li></ul><h2 id=receiving-the-verifiable-credential-in-your-application>Receiving the Verifiable Credential in your Application<a class=td-heading-self-link href=#receiving-the-verifiable-credential-in-your-application aria-label="Heading self-link"></a></h2><p>After the execution of the Authorization Code Flow, your Application can receive the Verifiable Credential in two ways:</p><ul><li><p>As an additional claim in the Access Token from the VCVerifier Token Endpoint. When your Application calls the Token Endpoint, it receives a normal access token which includes the claim <strong>verifiableCredential</strong>, which is the LEARCredential in JSON format.</p></li><li><p>As an additional claim in the response from the Userinfo endpoint. The claim name is the same as in the access token: <strong>verifiableCredential</strong>.</p></li></ul><p>The contents of the LEARCredential can be used by the Application to perform not only authentication but also authorization (access control). For example, using the Powers of the User which are included in the LEARCredential.</p><h1 id=machine-to-machine-m2m-authentication-flow>Machine-to-Machine (M2M) authentication flow<a class=td-heading-self-link href=#machine-to-machine-m2m-authentication-flow aria-label="Heading self-link"></a></h1><figure class="card rounded p-2 td-post-card mb-4 mt-4"><img src=/architecture/docs/identity/20_authentication/DOMEAuthentication-M2M-flow-overview.drawio.png alt="A server authenticating with Verifiable Credentials"><figcaption class="card-body px-0 pt-2 pb-0"><p>A server authenticating with Verifiable Credentials</p></figcaption></figure><p>The VCVerifier component of DOME support also the M2M flows. The figure above shows a server application using the VCVerifier to exchange a Verifiable Credential for an Access Token, and then using the token to access protected resources. The M2M (machine-to-machine) flow for authentication is simpler than the one for H2M, because there is no user authentication involved.</p><p>The credential used by the Application for authenticating to the VCVerifier is the LEARCredential that was generated for the Application when registering it to the VCVerifier (the same process as in the H2M flow).</p><p>The M2M flow uses the <strong>Client Credentials Grant</strong>, following the <a href=https://datatracker.ietf.org/doc/html/draft-ietf-oauth-v2-1-10>OAuth 2.1 IETF draft (12 July 2024)</a>, which among other things takes into account the <a href=https://oauth.net/2/oauth-best-practice/>OAuth 2.0 Security Best Current Practice</a> and consolidates several new RFCs that are relevant for our use case.</p><h2 id=authenticating-and-receiving-an-access-code>Authenticating and receiving an Access Code<a class=td-heading-self-link href=#authenticating-and-receiving-an-access-code aria-label="Heading self-link"></a></h2><p>The M2M flow uses a Token Endpoint specifically for M2M:</p><ul><li><strong>M2M Token Endpoint</strong>: <a href=https://verifier.dome-marketplace-prd.org/token_m2m>https://verifier.dome-marketplace-prd.org/token_m2m</a></li></ul><p>This is an example request to the M2M Token Endpoint:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=display:flex><span><span style=color:#000>POST</span> <span style=color:#000>/token_m2m</span> <span style=color:#204a87;font-weight:700>HTTP</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#0000cf;font-weight:700>1.1</span>
</span></span><span style=display:flex><span><span style=color:#000>Host</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000>verifier.dome-marketplace.org</span>
</span></span><span style=display:flex><span><span style=color:#000>Content-Type</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000>application/x-www-form-urlencoded</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    grant_type=client_credentials&amp;
</span></span><span style=display:flex><span>    client_assertion_type=urn%3Aietf%3Aparams%3Aoauth%3Aclient-assertion-type%3Ajwt-bearer&amp;
</span></span><span style=display:flex><span>    client_assertion=eyJhbGciOiJS[...omitted for brevity...]cC4hiUPo
</span></span></code></pre></div><p>The M2M flow MUST use the Client Credentials Grant (<strong>grant_type=client_credentials</strong>), because there is no user involved.</p><p>For authentication, the Application MUST use the <strong>private_key_jwt</strong> method, as described in section <a href=https://openid.net/specs/openid-connect-core-1_0.html#ClientAuthentication>9. Client Authentication</a> of the OIDC standard.</p><p>The value of the <strong>client_assertion_type</strong> parameter MUST be <strong>urn:ietf:params:oauth:client-assertion-type:jwt-bearer</strong>, and the authentication token MUST be sent as the value of the <strong>client_assertion</strong> parameter.</p><p>The authentication token is created by the Application using the LEARCredential. The JWT in the <strong>client_assertion</strong> contains:</p><ul><li><p><strong>iss</strong>: REQUIRED. This MUST contain the client_id of the OAuth Client, which is the <code>did</code> assigned to the machine in the LEARCredential of the machine. For example <strong>did:key:wejkdew87fwhef9833f4</strong></p></li><li><p><strong>sub</strong>: REQUIRED. This MUST contain the same value as the <code>iss</code> claim.</p></li><li><p><strong>aud</strong>: REQUIRED. The aud (audience) claim MUST contain the URL of the VCVerifier&rsquo;s M2M Token Endpoint (<a href=https://verifier.dome-marketplace-prd.org/token_m2m)>https://verifier.dome-marketplace-prd.org/token_m2m)</a>. The value shall be sent as a string, not as an item in an array.</p></li><li><p><strong>jti</strong>: REQUIRED. JWT ID. A unique identifier for the token, which can be used to prevent reuse of the token. Ideally, these tokens are used once. Given the very low value of the expiration time of the JWT (see below), the cache of already used <code>jti</code> claims can be held in memory, because an expired JWT MUST not be accepted even if the <code>jti</code> has not been seen before.</p></li><li><p><strong>exp</strong>: REQUIRED. Expiration time on or after which the JWT MUST NOT be accepted for processing. In a M2M flow, this JWT is used only once and the client generates the JWT immediately before using it to call the token endpoint of the VCVerifier, with no human intervention or intermediate complex processes. The expiration time MUST be set as low as possible while allowing network delays, the major component that may affect this parameter. For example, <strong>10 seconds</strong>, which is more than enough in most situations. In case of bad network conditions, the authentication can be retried with a new JWT. This is important for Replay protection, while simplifying management of unique <code>jti</code> claims in VC Verifier.</p></li><li><p><strong>iat</strong>: OPTIONAL. Time at which the JWT was issued.</p></li><li><p><strong>verifiableCredential</strong>: REQUIRED. This MUST contain the LEARCredential in JWT format.</p></li></ul><p>The authentication token MUST be signed with the private key associated to the did:key uniquely associated to the machine/application calling the M2M Token Endpoint, which MUST be the same as the did:key inside the LEARCredential in the <strong>verifiableCredential</strong> claim of the authentication token.</p><p>If the VCVerifier authenticates correctly the Application, it answers with an Access Token as described in section <a href=https://openid.net/specs/openid-connect-core-1_0.html#TokenResponse>3.1.3.3. Successful Token Response</a> of the OIDC specification.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-8d7286a5b9fd6ef45bb80b32283d09ca>5.3 - Powers</h1><div class=lead>A taxonomy of the powers or representation in DOME.</div><table><thead><tr><th>tmf_type</th><th>tmf_domain</th><th>tmf_function</th><th>tmf_action</th><th>Description</th></tr></thead><tbody><tr><td>Domain</td><td>DOME</td><td>Onboarding</td><td>Execute</td><td>Perform the onboarding process in DOME</td></tr><tr><td>Domain</td><td>DOME</td><td>ProductOffering</td><td>Create</td><td>Create a ProductOffering in the marketplace</td></tr><tr><td>Domain</td><td>DOME</td><td>ProductOffering</td><td>Update</td><td>Update a ProductOffering in the marketplace</td></tr><tr><td>Domain</td><td>DOME</td><td>ProductOffering</td><td>Delete</td><td>Delete a ProductOffering in the marketplace</td></tr><tr><td>Domain</td><td>DOME</td><td>Certification</td><td>Upload</td><td>Upload a Verifiable Certification to the marketplace, associated to a Product</td></tr></tbody></table></div><div class=td-content style=page-break-before:always><h1 id=pg-22ca1bc8db2ac3cc5e68ac62f23b328f>5.4 - Access Control</h1><div class=lead>Performing access control with Verifiable Credentials acting as Electronic Mandates.</div><div class="pageinfo pageinfo-primary"><p>This is a placeholder, content is being added.</p></div></div><div class=td-content style=page-break-before:always><h1 id=pg-2e396586ba727f8df9221cf7d5733a86>6 - Service Certification</h1><div class=lead>Demonstrating that your services comply with the required official certifications.</div><h2 id=verifiable-certifications-are-required-for-trusted-decentralised-replication>Verifiable Certifications are required for trusted decentralised replication<a class=td-heading-self-link href=#verifiable-certifications-are-required-for-trusted-decentralised-replication aria-label="Heading self-link"></a></h2><figure class="card rounded p-2 td-post-card mb-4 mt-4"><img src=/architecture/docs/certification/verifiable-certificates-and-replication.png></figure><h2 id=verifiable-certifications-and-gaia-x>Verifiable Certifications and Gaia-X<a class=td-heading-self-link href=#verifiable-certifications-and-gaia-x aria-label="Heading self-link"></a></h2><figure class="card rounded p-2 td-post-card mb-4 mt-4"><img src=/architecture/docs/certification/verifiable-certificates-gaiax.png></figure><h2 id=the-process-for-obtaining-a-verifiable-certification>The process for obtaining a Verifiable Certification<a class=td-heading-self-link href=#the-process-for-obtaining-a-verifiable-certification aria-label="Heading self-link"></a></h2><h3 id=the-future-is-all-digital>The future is all digital<a class=td-heading-self-link href=#the-future-is-all-digital aria-label="Heading self-link"></a></h3><figure class="card rounded p-2 td-post-card mb-4 mt-4"><img src=/architecture/docs/certification/verifiable-certificates-digital.png></figure><h3 id=but-the-present-includes-manual-processes>But the present includes manual processes<a class=td-heading-self-link href=#but-the-present-includes-manual-processes aria-label="Heading self-link"></a></h3><figure class="card rounded p-2 td-post-card mb-4 mt-4"><img src=/architecture/docs/certification/verifiable-certificates-manual.png></figure></div><div class=td-content style=page-break-before:always><h1 id=pg-7c742aa5039751635a3d8b7919c51966>7 - Company registration</h1><div class=lead>Registering your company in DOME Marketplace.</div><p>Before your company can create a Product Offering in the DOME Marketplace, it has to be registered as a Participant in the DOME ecosystem. The process of registering the company in a trusted way is called <strong>onboarding</strong>.</p><p>The onboarding process must be performed by a natural person, normally an employee of the company acting on behalf of the company.</p><p>A common problem in decentralised ecosystems is how organisations can onboard the ecosystem in a trusted and automated way, avoiding manual paperwork. DOME implements an efficient and secure mechanism to onboard companies which are in the digital age, by leveraging the powers of standard eIDAS certificates.</p><p>For companies which can not digitally sign electronic transactions according to the eIDAS framework, DOME provides the manual processes (slower and more cumbersome) that enable those companies to onboard DOME.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-ad4564e2ca35cc0862b65da41d4ab5fa>7.1 - Overview</h1><div class=lead>A general description of the approach to onboarding in DOME.</div><div class="pageinfo pageinfo-primary"><p>This is a placeholder page. Content is being created.</p></div></div><div class=td-content style=page-break-before:always><h1 id=pg-4c57c1f351fde75c7ef3b9f12b1f3857>7.2 - LEARCredential (digital process)</h1><div class=lead>Creating a LEARCredential for an employee, the automated and self-service way.</div><h2 id=go-to-the-dome-issuer-portal>Go to the DOME Issuer portal<a class=td-heading-self-link href=#go-to-the-dome-issuer-portal aria-label="Heading self-link"></a></h2><p>The DOME Issuer portal is located at <a href=https://dome.mycredential.eu/>https://dome.mycredential.eu/</a> and below is an image of the screen.</p><p><img alt="DOME Issuer portal" src=../dome_issuer_home.png></p><p>The site is intended for Legal Representatives of companies who want to issue one or more LEARCredentials to one or more employees of the company. A LEARCredential is a type of Verifiable Credential which enables an employee, nominated by a legal representative, to act on behalf of an organisation with restricted powers with respect to third-parties.</p><figure class="card rounded p-2 td-post-card mb-4 mt-4"><img src=/architecture/docs/registration/lear_digital/featured-dome_issuer_home.png alt="An elephant at sunset"><figcaption class="card-body px-0 pt-2 pb-0"><p>An elephant at sunset</p></figcaption></figure><p>The issuer (the creator) of the LEARCredential must be a legal representative of the company. The legal representative will sign the LEARCredential with an eIDAS digital certificate, which can be either a personal one or a certificate of representation.</p><figure class="card rounded p-2 td-post-card mb-4 mt-4"><a href=https://www.google.com><img src=/architecture/docs/registration/lear_digital/featured-dome_issuer_home.png alt="An elephant at sunset"></a><figcaption class="card-body px-0 pt-2 pb-0"><p>An elephant at sunset</p></figcaption></figure><p>The receiver of the LEARCredential (both the subject and holder of the credential) can be any employee (or contractor) of the company. The legal representative will delegate a restricted set of powers to that person. Those restricted powers are included inside the credential and can be verified by any Relying party to whom the holder presents the LEARCredential.</p><p>If you are a legal representative of the company and you have an eIDAS certificate installed in your PC, click on the yellow button to start the process:</p><p><img alt="Go to Issuer" src=/docs/onboarding/login_as_legal_representative.png></p><h2 id=select-the-eidas-certificate-to-use>Select the eIDAS certificate to use<a class=td-heading-self-link href=#select-the-eidas-certificate-to-use aria-label="Heading self-link"></a></h2><p>Once you click the button, you will be directed to the page of the DOME Issuer to start creating LEARCredentials.</p><p>The browser will request that you select the certificate to use, with a screen like the following:</p><p><img alt="Select certificate" src=/docs/onboarding/select_certificate.png></p><h2 id=register-for-the-service>Register for the service<a class=td-heading-self-link href=#register-for-the-service aria-label="Heading self-link"></a></h2><p>The first time you enter, you must register and verify your company email, using the following screen.</p><p><img alt="Register email" src=/docs/onboarding/register_email.png></p><p>Enter your email address and click the button &ldquo;Register (if this is the first time)&rdquo;.</p><p>You will receive an email requesting confirmation, which is needed before you can logon in the system.</p><p>If you do not receive the email (from <a href=mailto:support@mycredential.eu>support@mycredential.eu</a>), please check in spam just in case your email client has automatically classified it as spam.</p><p>Once you have verified your email you can logon in the system using the same screen as above.</p><h2 id=list-of-learcredentials>List of LEARCredentials<a class=td-heading-self-link href=#list-of-learcredentials aria-label="Heading self-link"></a></h2><p>After logging in for the first time, you will see an empty screen like the following. Click on the button to create a new LEARCredential.</p><p><img alt="List of Offers 1" src=/docs/onboarding/list_of_offers_1.png></p><h2 id=learcredentialform>LEARCredentialForm<a class=td-heading-self-link href=#learcredentialform aria-label="Heading self-link"></a></h2><p>A form to fill the data of the LEARCredential appears, like the following:</p><p><img alt="LEARCredential form" src=/docs/onboarding/credential_form_1.png></p><p>The form has the following sections:</p><h3 id=mandator>Mandator<a class=td-heading-self-link href=#mandator aria-label="Heading self-link"></a></h3><p>The Mandator is the person delegating a restricted set of powers onto an employee (the Mandatee). This part of the form is pre-filled with information coming from the eIDAS certificate that was used to enter into the application, plus the email address that was registered and verified.</p><p>You do not have to enter anything else in this section.</p><p><img alt=Mandator src=/docs/onboarding/mandator.png></p><h3 id=mandatee>Mandatee<a class=td-heading-self-link href=#mandatee aria-label="Heading self-link"></a></h3><p>The Mandatee is the employee (or subcontractor) who receives a restricted set of powers to act on behalf of the company with third-parties. In our case, the employee will be empowered to perform the Onboarding process in DOME, and maybe to create Product Offerings in the Marketplace.</p><p>You have to fill the data corresponding to the employee that you want to nominate to perform the Onboarding process. After creating the LEARCredential, the employee will receive a notification in the email address that you entered in the form.</p><p><img alt=Mandatee src=/docs/onboarding/mandatee.png></p><h3 id=powers>Powers<a class=td-heading-self-link href=#powers aria-label="Heading self-link"></a></h3><p>These are the specific powers that the Mandator (you) is delegating on the Mandatee (the employee).</p><p>The LEARCredential is a general purpose electronic Mandate, but in our case we need only two powers:</p><ul><li>Execute the Onboarding process in DOME</li><li>Create/Update/Delete one or more Product Offerings in the DOME Marketplace</li></ul><p><img alt=Powers src=/docs/onboarding/powers.png></p><p>You can assign each power to a different employee (with one LEARCredential for each employee), or both powers to the same employee (with one LEARCredential including both powers). You can even generate more than one LEARCredential with the same or different powers to one or more employees. This is up to you and how you want to distribute the powers among your employees.</p><p>The Mandate in the form of a Verifiable Credential bechaves like its paper counterpart with regards to these properties.</p><p>For Onboarding, make sure that the employee receives at least the Onboarding power:</p><p><img alt=Onboarding src=/docs/onboarding/powers_onboarding.png></p><h2 id=create-a-first-version-of-the-learcredential>Create a first version of the LEARCredential<a class=td-heading-self-link href=#create-a-first-version-of-the-learcredential aria-label="Heading self-link"></a></h2><p>Press the &ldquo;Create&rdquo; button at the bottom of the form. This will take you to a screen with the machine-readable representation of the new LEARCredential. Do not worry, you do not have to understand this, but if you do (or somebody in your company) it is a good way to see the actual contents that will go inside the LEARCredential, before sending it to the employee.</p><p><img alt="JSON model Onboarding" src=/docs/onboarding/json_credential_offer.png></p><p>Click the button at the bottom of the screen to save the draft version of the credential and send a notification to the target employee via email.</p><h2 id=list-of-created-learcredentials>List of created LEARCredentials<a class=td-heading-self-link href=#list-of-created-learcredentials aria-label="Heading self-link"></a></h2><p>You are taken back to the list of LEARCredentials that you have created. If this is the first time that you have created a credential, thee screen looks like the following.</p><p><img alt="List of one credential" src=/docs/onboarding/list_of_offers_one_credential.png></p><p>The button &ldquo;View&rdquo; at the left of every item allows you to review the credential, and also to send a reminder email to the target employee, in case the employee has not yet retrieved the credential.</p><p>LEARCredentials have three states:</p><ul><li><strong>offered</strong>: A draft version of the credential has been created with all required information about Mandator, Mandatee and the Powers of Representation. A notification via email has been sent to the employee who will receive the powers. The name <code>offered</code> denotes that the employee has to accept the credential and load it to the Wallet of th eemployee.</li><li><strong>tobesigned</strong>: The employee has accepted the LEARCredential, after reviewing the information contained in it. This step is necessary because the LEARCredential contains cryptographic material which will allow the employee to authenticate to DOME, and that cryptographic material can only be generated by the Wallet of the employee, to ensure the solo control of the private key.</li><li><strong>signed</strong>: After the employee accepts the credential, you have to sign it with your eIDAS certificate. After your signature, the credential is signed and ready to be loaded by the employee in her Wallet and use it.</li></ul><h2 id=the-employee-reviews-and-confirms-the-learcredential>The employee reviews and confirms the LEARCredential<a class=td-heading-self-link href=#the-employee-reviews-and-confirms-the-learcredential aria-label="Heading self-link"></a></h2><p>The employee receives an email notification like the one below.</p><p><img alt="Employee email notification initial" src=/docs/onboarding/employee_offer_notification.png></p><p>When clicking on the button, the employee is directed to the DOME Issuer portal to review and (possibly) confirm the LEARCredential.</p><p>The screen that the employee sees is similar to the one below.</p><p><img alt="Employee Issuer portal initial" src=/docs/onboarding/employee_credential_accept_portal.png></p><p><img alt="Wallet review offer" src=/docs/onboarding/wallet_review_offered_credential.png></p></div><div class=td-content style=page-break-before:always><h1 id=pg-df23d5d93d142604a701c7b1cbd33989>7.3 - LEARCredential (manual process)</h1><div class=lead>Creating a LEARCredential for an employee, the manual way.</div><div class="pageinfo pageinfo-primary"><p>This is a placeholder page. Content is being created.</p></div></div><div class=td-content style=page-break-before:always><h1 id=pg-c57585a65dd796097af46d460d6da26a>7.4 - Powers of Representation</h1><div class=lead>The Mandate (Powers of Representation), authorising employees to act on behalf of the company.</div><div class="pageinfo pageinfo-primary"><p>This is a placeholder page. Content is being created.</p></div></div></main></div></div><footer class="td-footer row d-print-none"><div class=container-fluid><div class="row mx-md-2"><div class="td-footer__left col-6 col-sm-4 order-sm-1"></div><div class="td-footer__right col-6 col-sm-4 order-sm-3"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=GitHub aria-label=GitHub><a target=_blank rel=noopener href=https://github.com/google/docsy aria-label=GitHub><i class="fab fa-github"></i></a></li></ul></div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2"><span class=td-footer__copyright>&copy;
2024&ndash;2024
<span class=td-footer__authors>DOME Marketplace Authors | <a href=https://creativecommons.org/licenses/by/4.0>CC BY 4.0</a> |</span></span><span class=td-footer__all_rights_reserved>All Rights Reserved</span><span class=ms-2><a href=https://dome-marketplace.eu/ target=_blank rel=noopener>Privacy Policy</a></span></div></div></div></footer></div><script src=/architecture/js/main.min.0c108d8fb34083a7e131165ab476d1c0834e1bec585155e773f2cb0e8534298a.js integrity="sha256-DBCNj7NAg6fhMRZatHbRwINOG+xYUVXnc/LLDoU0KYo=" crossorigin=anonymous></script><script defer src=/architecture/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js integrity="sha256-c0eKfUgHaYrtfjVesj+YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin=anonymous></script><script src=/architecture/js/tabpane-persist.js></script></body></html>